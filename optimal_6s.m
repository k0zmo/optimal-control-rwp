clc, clear all, close all, format long e, format compact

% Parametry fizyczny ukladu
global m g l J Jr k
m = 0.3014;
g = 9.81;
l = 0.12;
J = 0.004572;
Jr = 0.00002495;
k = 0.0274;

% Macierz wagowa dla wskaznika jakosci
global W
W = eye(4,4);
W(1,1)=50;
W(2,2)=50;
W(3,3)=0;
W(4,4)=1;

% Warunki poczatkowy i koncowy
x0 = [-pi 0 0 0];
xf = [0 0 0 0];

% Krok calkowania
h0=0.01;

% Przyblizenie poczatkowe sterowania
u0=-1;
tau = [0                   ...
	   0.08551463282031953 ...
	   0.3983462665112307  ...
	   0.7969620589167699  ...
	   1.116845136866308   ...
	   1.521325301282805   ...
	   1.848019003674786   ...
	   2.26558916872094    ...
	   2.831504790861097   ...
	   2.838424725685214   ...
	   3.377922733274885   ...
	   3.817123479763285   ...
	   4.184233803229644   ...
	   4.671676819489521   ...
	   5.092624046163292   ...
	   5.843564937374666   ...
	   5.843897752342129   ...
	   5.853212408870137   ...
	   6];

[dQ, Q, x, t, psi, H1] = gradient(tau, u0, x0, h0, xf);
plotcharts(t, x, H1, tau, u0);
[Q, dQ]